@model List<Products_MVC_Project.Models.Product>

@{
    ViewData["Title"] = "Products Starting With " + ViewBag.Letter;
    var letter = ViewBag.Letter as string;
}

<div class="container mt-4">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="display-6">
                <i class="bi bi-fonts text-info"></i>
                Products Starting With
                <span class="text-info fw-bold">'@letter'</span>
            </h1>
            <p class="text-muted">Alphabetical listing of products starting with the letter @letter</p>
        </div>
        <a asp-action="NameStartsWith" class="btn btn-outline-info">
            <i class="bi bi-arrow-repeat"></i> New Letter Search
        </a>
    </div>

    <!-- Results Summary -->
    <div class="alert alert-info">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h5 class="alert-heading">
                    <i class="bi bi-info-circle"></i> Search Results
                </h5>
                <p class="mb-0">
                    Found <strong>@Model.Count</strong> product(s) starting with
                    <strong class="text-uppercase">'@letter'</strong>
                </p>
            </div>
            @if (Model.Any())
            {
                <div class="text-end">
                    <small class="text-muted">
                        Total Value: <strong>$@Model.Sum(p => p.Price).ToString("F2")</strong>
                    </small>
                </div>
            }
        </div>
    </div>

    @if (Model.Any())
    {
        <!-- Products Table -->
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0">
                    <i class="bi bi-list-ul"></i> Products List
                </h5>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead class="table-info">
                            <tr>
                                <th class="ps-4">ID</th>
                                <th>Product Name</th>
                                <th>Price</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var product in Model)
                            {
                                <tr>
                                    <td class="ps-4 fw-bold">#@product.Id</td>
                                    <td>
                                        <span class="fw-bold text-primary">@product.Name</span>
                                    </td>
                                    <td>
                                        <span class="badge bg-success fs-6">$@product.Price.ToString("F2")</span>
                                    </td>
                                    <td class="text-center">
                                        <div class="btn-group btn-group-sm" role="group">
                                            <a asp-action="Details" asp-route-id="@product.Id"
                                               class="btn btn-outline-info" title="View Details">
                                                <i class="bi bi-eye"></i> Details
                                            </a>
                                            <a asp-action="Edit" asp-route-id="@product.Id"
                                               class="btn btn-outline-warning" title="Edit Product">
                                                <i class="bi bi-pencil"></i> Edit
                                            </a>
                                            <a asp-action="Delete" asp-route-id="@product.Id"
                                               class="btn btn-outline-danger" title="Delete Product">
                                                <i class="bi bi-trash"></i> Delete
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row mt-4">
            <div class="col-md-4">
                <div class="card text-center border-info">
                    <div class="card-body">
                        <h5 class="card-title text-info">
                            <i class="bi bi-currency-dollar"></i> Average Price
                        </h5>
                        <h3 class="text-info">$@Model.Average(p => p.Price).ToString("F2")</h3>
                        <p class="text-muted">Average price of products</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center border-success">
                    <div class="card-body">
                        <h5 class="card-title text-success">
                            <i class="bi bi-arrow-up"></i> Highest Price
                        </h5>
                        <h3 class="text-success">$@Model.Max(p => p.Price).ToString("F2")</h3>
                        <p class="text-muted">Most expensive product</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center border-warning">
                    <div class="card-body">
                        <h5 class="card-title text-warning">
                            <i class="bi bi-arrow-down"></i> Lowest Price
                        </h5>
                        <h3 class="text-warning">$@Model.Min(p => p.Price).ToString("F2")</h3>
                        <p class="text-muted">Least expensive product</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Letter Navigation -->
        <div class="card mt-4">
            <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0">
                    <i class="bi bi-compass"></i> Quick Navigation
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Search for products starting with other letters:</p>

                <div class="text-center">
                    @for (char c = 'A'; c <= 'Z'; c++)
                    {
                        <a asp-action="NameStartsWithDirect" asp-route-letter="@c"
                           class="btn @(c.ToString() == letter ? "btn-info" : "btn-outline-primary") btn-sm m-1"
                           style="width: 45px; height: 45px; font-weight: bold;"
                           title="Products starting with '@c'">
                            @c
                        </a>
                    }
                </div>

                <!-- Number Navigation -->
                <div class="text-center mt-3">
                    <p class="text-muted mb-2">Or search by numbers:</p>
                    @for (char c = '0'; c <= '9'; c++)
                    {
                        <a asp-action="NameStartsWithDirect" asp-route-letter="@c"
                           class="btn @(c.ToString() == letter ? "btn-secondary" : "btn-outline-secondary") btn-sm m-1"
                           style="width: 45px; height: 45px; font-weight: bold;"
                           title="Products starting with '@c'">
                            @c
                        </a>
                    }
                </div>
            </div>
        </div>
    }
    else
    {
        <!-- No Results Found -->
        <div class="card text-center border-warning">
            <div class="card-body py-5">
                <div class="mb-4">
                    <i class="bi bi-search display-1 text-warning"></i>
                </div>
                <h3 class="text-warning">No Products Found</h3>
                <p class="text-muted mb-4">
                    No products start with the letter <strong>'@letter'</strong>.
                    Try searching for a different letter.
                </p>

                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Try These Popular Letters:</h5>
                                <div class="d-flex justify-content-center flex-wrap gap-2">
                                    @{
                                        var popularLetters = new[] { "A", "B", "C", "S", "T", "M", "P", "E" };
                                    }
                                    @foreach (var popularLetter in popularLetters)
                                    {
                                        <a asp-action="NameStartsWithDirect" asp-route-letter="@popularLetter"
                                           class="btn btn-outline-primary">
                                            @popularLetter
                                        </a>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }

    <!-- Action Buttons -->
    <div class="mt-4 d-flex justify-content-between">
        <div>
            <a asp-action="NameStartsWith" class="btn btn-info me-2">
                <i class="bi bi-search"></i> New Letter Search
            </a>
            <a asp-action="Search" class="btn btn-outline-secondary me-2">
                <i class="bi bi-text-left"></i> Text Search
            </a>
        </div>
        <a asp-action="Index" class="btn btn-primary">
            <i class="bi bi-grid"></i> View All Products
        </a>
    </div>
</div>

@section Styles {
    <style>
        .table th {
            border-top: none;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }

        .btn-group .btn {
            border-radius: 6px;
            margin: 0 2px;
        }

        .card {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: none;
            border-radius: 10px;
        }

        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
        }

        .table-responsive {
            border-radius: 0 0 10px 10px;
        }

        .badge {
            font-size: 0.8rem;
            padding: 0.5em 0.75em;
        }
    </style>
}

@section Scripts {
    <script>
        // Add hover effects to table rows
        document.querySelectorAll('tbody tr').forEach(row => {
            row.addEventListener('mouseenter', function() {
                this.style.transform = 'translateX(5px)';
                this.style.transition = 'transform 0.2s ease';
            });

            row.addEventListener('mouseleave', function() {
                this.style.transform = 'translateX(0)';
            });
        });

        // Add animation to statistics cards
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.classList.add('animate__animated', 'animate__fadeInUp');
            });
        });
    </script>
}